@page "/certificate-of-no-records/{RequestId}/{IsExporting}";
@page "/certificate-of-no-records/{RequestId}";
@using DPWH.EDMS.Components.Helpers;
@inherits CertificateOfNoRecordBase

<EdmsLoader Visible="IsLoading" />
<div class="d-flex justify-content-end pt-3" style="width: 22cm; margin-left: auto; margin-right: auto;">
    <TelerikButton Class="float-right" Icon="@SvgIcon.Download" OnClick="@ExportPdf">
        Export PDF
    </TelerikButton>
</div>

@if (!string.IsNullOrEmpty(User.Office))
{
    <div class="container page-legal-size" style="width:794px">
        <div class="container" @ref="PdfContainerRef">
            <div class="printable-design">
                <div class="row">
                    <div class="col-2"><img src="_content/DPWH.EDMS.Components/images/dpwh_dark.png" alt="Logo" width="89"></div>
                    <div class="header-container col-8 d-flex justify-content-center">
                        <div class="text-center">
                            <p class="text-decoration-none fw-normal">Republic of the Philippines</p>
                            <p class="text-decoration-none fw-normal">DEPARTMENT OF PUBLIC WORKS AND HIGHWAYS</p>
                            <p class="text-decoration-none fw-bolder">CENTRAL OFFICE</p>
                            <p class="text-decoration-none fw-normal">Manila</p>
                        </div>
                    </div>
                    <div class="col-2"><img src="_content/DPWH.EDMS.Components/images/bagong-pilipinas-logo.png" alt="Logo" width="89"></div>
                </div>
                <div class="my-5" />

                <h1 style="padding-left: 1pt;text-indent: 0pt;text-align: center; margin-bottom:50px;">CERTIFICATE OF NO RECORDS</h1>

                <p style="padding-left: 6pt;text-indent: 0pt;text-align: justify;margin-bottom:20px;">To Whom It May Concern:</p>

                <p style="width:auto; padding-left: 6pt;text-indent: 0pt;text-align: justify;">This is to certify that a thorough search of the files at the Non-Current Records Section was carried out under my supervision. The search was based on the information provided to our office and has revealed no record of the following:</p>
                <div class="my-5">
                    @if (SelectedRecordRequest.RequestedRecords != null && SelectedRecordRequest.RequestedRecords.Count > 0)
                    {
                        var office = !string.IsNullOrEmpty(User.Office) ? User.Office : "";
                        var norecords = SelectedRecordRequest.RequestedRecords.Where(x => x.Uri == null).ToList();
                        int count = 0;
                        foreach (var item in norecords)
                        {
                            if (item.Office == office)
                            {
                                count++;
                                <p class="fw-bolder" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><span class="fw-normal">@count</span>. @item.RecordType</p>
                            }

                        }
                    }
                </div>


                <p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Issued this <span class="s2 fw-bolder">&nbsp;@GetDayWithSuffix(DateTime.Now.Day) &nbsp; </span>day of <span class="s2 fw-bolder">&nbsp; @(DateTime.Now.ToString("MMMM") + ", " + DateTime.Now.Year) &nbsp; </span>.</p>
                <div class="spacer-container" />

                @if(GridData != null && GridData.Count > 0)
                {
                    var firstSignatory = GridData.FirstOrDefault(x => x.SignatoryNo == 0);
                    var secondSignatory = GridData.FirstOrDefault(x => x.SignatoryNo == 1);

                    <h2 style="padding-left: 6pt;text-indent: 0pt;text-align: left;">@firstSignatory!.Name</h2>
                    <p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">@firstSignatory!.Position</p>
                    <p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">@firstSignatory!.Office1</p>
                    <p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">@firstSignatory!.Office2</p>
                    <p style="padding-top: 13pt;text-indent: 0pt;text-align: left;"><br /></p>
                    <h2 style="padding-left: 6pt;text-indent: 0pt;text-align: left;margin-bottom:30px;">NOTED:</h2>

                    <h2 style="padding-left: 6pt;text-indent: 0pt;line-height: 13pt;text-align: left;">@secondSignatory!.Name</h2>
                    <p style="padding-left: 6pt;text-indent: 0pt;line-height: 13pt;text-align: left;">@secondSignatory!.Position</p>
                    <p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">@secondSignatory!.Office1, @secondSignatory!.Office2</p>
                }
                

            </div>
        </div>

    </div>

}
 